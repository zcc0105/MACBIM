# coding:UTF-8
import os
import random
import torch as T
import numpy as np
from scipy.stats import norm


class SeedsInfo:
    def __init__(self) -> None:
        self.datasets = [os.getcwd() + '/dataset/Cit-HepPh.txt',
                         os.getcwd() + '/dataset/com-dblp.ungraph.txt',
                         os.getcwd() + '/dataset/facebook_combined.txt',
                         os.getcwd() + '/dataset/p2p-Gnutella09.txt',
                         os.getcwd() + '/dataset/BA.txt']
        self.num_agents = 1  # number of the competitors
        self.num_seeds = 1
        self.item = 3  # index for dataset
        self.dataset_item = 0  # index for seed set
        self.budget = [0, 0]  # when |seeds|=20, budgets change to [10,10]
        self.seeds = {
            'cit': [[9207217, 9609432, 9402208, 9603336, 9411366],
                    [9207217, 9609432, 9402208, 9603336, 9411366, 9304307, 9901210],
                    [9207217, 9609432, 9402208, 9603336, 9411366, 9304307, 9901210, 9912238, 9608387],
                    [9803315, 9804398, 9407339, 9512380, 9606399, 9807344, 9306320, 9905221, 9408384,
                     9507378, 9604387, 9807216, 9903282, 9410404, 9303230, 9803445, 9209205, 9209232,
                     9304225, 9705442],
                    [9803315, 9804398, 9407339, 9512380, 9606399, 9807344, 9306320, 9905221, 9408384, 9507378, 9604387,
                     9807216, 9903282, 9410404, 9303230, 9803445, 9209205, 9209232, 9304225, 9705442, 9302210, 9308246,
                     9603249, 9508343, 9803466, 9704207, 9207214, 9802290, 9806404, 9309289, 9508347, 9806292, 9609381,
                     9402253, 9610451, 9811291, 9711395, 9506380, 9210235, 9905312, 9502298, 9306309, 9304257, 9402283,
                     9606211, 9711396, 9612313, 9801271, 9403338, 9404270],
                    [9803315, 9804398, 9407339, 9512380, 9606399, 9807344, 9306320, 9905221, 9408384, 9507378, 9604387,
                     9807216, 9903282, 9410404, 9303230, 9803445, 9209205, 9209232, 9304225, 9705442, 9302210, 9308246,
                     9603249, 9508343, 9803466, 9704207, 9207214, 9802290, 9806404, 9309289, 9508347, 9806292, 9609381,
                     9402253, 9610451, 9811291, 9711395, 9506380, 9210235, 9905312, 9502298, 9306309, 9304257, 9402283,
                     9606211, 9711396, 9612313, 9801271, 9403338, 9404270, 9502336, 9512406, 9811350, 9603208, 9308271,
                     9504316, 9411426, 9406315, 9304307, 9312272, 9806387, 9207234, 9611433, 9311345, 9303270, 9303320,
                     9307247, 9402360, 9804403, 9311205, 9609331, 9811337, 9302316, 9401310, 9203203, 6124, 9311269,
                     9811448, 9803389, 9303202, 9607394, 9411365, 9402364, 9811356, 9512336, 9310320, 9810442, 9807513,
                     9812448, 9312359, 9605323, 9208213, 9501334, 9401258, 9504378, 9207279, 9707435, 9311340, 9303284,
                     9501281],
                    [9803315, 9512380, 9804398, 9407339, 9606399, 9807344, 9306320, 201071, 9905221, 9507378, 9408384,
                     101336, 9604387, 9807216, 9903282, 3154, 9603208, 9803445, 9801271, 9410404, 9806471, 9705442,
                     9303230, 9209205, 9209232, 9304225, 9506380, 5025, 9302210, 9610451, 9812360, 9508343, 9308246,
                     9603249, 9704207, 9806404, 9704376, 9811291, 9712301, 9803466, 9606211, 9802290, 9806292, 9508347,
                     9207214, 9709356, 10338, 9309289, 9402253, 9609381, 9807443, 207108, 6124, 9711395, 208209, 209244,
                     202122, 9905312, 9210235, 9612313, 9502298, 9306309, 9304257, 9811350, 9312272, 9711396, 9402283,
                     202058, 9512406, 3033, 9403338, 9404270, 9502336, 9806387, 9411426, 9504316, 106315, 9308271,
                     9406315, 204316, 206077, 9611433, 9304307, 9707435, 9311269, 9402360, 9609331, 9311345, 9207234,
                     204031, 9811448, 9803389, 9307247, 9804403, 9303320, 9607394, 9810442, 9303270, 9811337, 206169,
                     9504378, 9807278, 9411365, 9512336, 104110, 5114, 9311205, 9302316, 9807513, 9401310, 9805303,
                     9402364, 9811356, 9808205, 9912358, 9203203, 9703290, 9605323, 9310320, 9303202, 4173, 9804363,
                     102122, 9709301, 203056, 9312359, 9811428, 101224, 9902371, 2258, 9812448, 9501334, 9311340, 9350,
                     9208213, 9501281, 9606388, 9501384, 9401258, 9904279, 3238, 9704452, 212304, 106258, 9207279,
                     9906469, 9802302, 9308288, 6032, 9810232, 11333, 9605342, 9810270, 9507282, 9903358, 9701390,
                     9303284, 9812472, 9408406, 9705477, 9211304, 3058, 9807235, 9805422, 9511315, 9705337, 9505329,
                     9602260, 9502300, 9906234, 106247, 9810457, 9704448, 9606337, 203079, 9710335, 201291, 301023,
                     9701231, 9401219, 9603420, 201146, 9402335, 9607372, 9812538, 9603404, 9303281, 9410280, 9412385,
                     9901362, 106012, 9704423, 9507462, 9808293, 9601208, 7218, 9707251, 9511288, 9601367, 9506451],
                    [9803315, 9512380, 9804398, 9407339, 9606399, 9807344, 9306320, 201071, 9905221, 9507378, 9408384,
                     101336, 9604387, 9807216, 9903282, 3154, 9603208, 9803445, 9801271, 9410404, 9806471, 9705442,
                     9303230, 9209205, 9209232, 9304225, 9506380, 5025, 9302210, 9610451, 9812360, 9508343, 9308246,
                     9603249, 9704207, 9806404, 9704376, 9811291, 9712301, 9803466, 9606211, 9802290, 9806292, 9508347,
                     9207214, 9709356, 10338, 9309289, 9402253, 9609381, 9807443, 207108, 6124, 9711395, 208209, 209244,
                     202122, 9905312, 9210235, 9612313, 9502298, 9306309, 9304257, 9811350, 9312272, 9711396, 9402283,
                     202058, 9512406, 3033, 9403338, 9404270, 9502336, 9806387, 9411426, 9504316, 106315, 9308271,
                     9406315, 204316, 206077, 9611433, 9304307, 9707435, 9311269, 9402360, 9609331, 9311345, 9207234,
                     204031, 9811448, 9803389, 9307247, 9804403, 9303320, 9607394, 9810442, 9303270, 9811337, 206169,
                     9504378, 9807278, 9411365, 9512336, 104110, 5114, 9311205, 9302316, 9807513, 9401310, 9805303,
                     9402364, 9811356, 9808205, 9912358, 9203203, 9703290, 9605323, 9310320, 9303202, 4173, 9804363,
                     102122, 9709301, 203056, 9312359, 9811428, 101224, 9902371, 2258, 9812448, 9501334, 9311340, 9350,
                     9208213, 9501281, 9606388, 9501384, 9401258, 9904279, 3238, 9704452, 212304, 106258, 9207279,
                     9906469, 9802302, 9308288, 6032, 9810232, 11333, 9605342, 9810270, 9507282, 9903358, 9701390,
                     9303284, 9812472, 9408406, 9705477, 9211304, 3058, 9807235, 9805422, 9511315, 9705337, 9505329,
                     9602260, 9502300, 9906234, 106247, 9810457, 9704448, 9606337, 203079, 9710335, 201291, 301023,
                     9701231, 9401219, 9603420, 201146, 9402335, 9607372, 9812538, 9603404, 9303281, 9410280, 9412385,
                     9901362, 106012, 9704423, 9507462, 9808293, 9601208, 7218, 9707251, 9511288, 9601367, 9506451,
                     101103, 9911293, 111198, 211331, 9903417, 9803277, 9705339, 9806328, 9708456, 9307364, 9604412,
                     9603391, 9403256, 102331, 9609434, 9407389, 3180, 9911321, 9210253, 10175, 9910205, 104283,
                     9905226, 9903422, 9710401, 9307201, 9905437, 12308, 9803479, 105155, 204314, 9501357, 9211321,
                     9408214, 9610461, 9602374, 9312311, 9805470, 9307291, 9302225, 9403290, 9604317, 108236, 9606345,
                     9212235, 9807358, 9511210, 9705292, 9703276, 9501369, 107316, 9802357, 212237, 9507453, 9809596,
                     9411229, 9802391, 9407247, 9308333, 9505359, 9812256, 9804233, 9505248, 9605431, 9701289, 9505425,
                     9508379, 9812287, 9503486, 9312319, 9212278, 103067, 9504324, 9405388, 9806308, 9802334, 9602366,
                     9702287, 9612446, 9606324, 212406, 9903535, 9303255, 203219, 9502366, 9712225, 9904408, 9712290,
                     9812475, 9209251, 9337, 104062, 9908288, 9605398, 9504219, 9702409, 9511397, 204299, 9404282,
                     106204, 9703288, 103280, 9602239, 9806540, 9807325, 9811390, 9306205, 9607383, 9907231, 102145,
                     9805494, 9609279, 9603378, 9404283, 102146, 9901281, 9909232, 9306242, 9311325, 9808312, 9904404,
                     111058, 2108, 9509389, 9804294, 9812397, 9510309, 9906224, 9802394, 9311214, 9910221, 7313,
                     9706307, 9603202, 9507319, 9803368, 10017, 9604351, 1002, 9606411, 9911459, 9401277, 9405410,
                     9304299, 9507386, 9703442, 9610323, 9403224, 9911272, 9607254, 204253, 201075, 206072, 9303241,
                     9907447, 9807353, 9505385, 9905220, 9610231, 9504327, 9205228, 9411211, 9905481, 7176, 4004,
                     9901208, 9905536, 106050, 9206242, 9807501, 9408404, 9308349, 9408228, 9711391, 109197, 9304295,
                     9610233, 9612269, 9509348, 9303205, 106264, 9811313, 9310233, 9610540, 9812252, 9703337, 9904211,
                     9911323, 108177, 9310379, 9211256, 9808272, 9802314, 1134, 9703353, 9210242, 9912231, 9307301,
                     9904353, 9801269]
                    ],
            'dblp': [[45479, 6737, 13884, 4799, 11457],
                     [45479, 6737, 13884, 4799, 11457, 6433, 13451],
                     [45479, 6737, 13884, 4799, 11457, 6433, 13451, 33126, 3420],
                     [38868, 45479, 57571, 6737, 72210, 63861, 96321, 13884, 11457,
                      21759, 98618, 31470, 46911, 13451, 19267, 116246, 33126, 4799, 6433, 15760],
                     [38868, 45479, 57571, 6737, 72210, 63861, 96321, 13884, 11457, 21759, 98618,
                      31470, 46911, 13451, 19267, 116246, 33126, 4799, 6433, 15760, 7427, 69476,
                      148255, 37335, 3420, 11323, 24074, 5470, 180399, 13830, 11711, 7465, 25347,
                      40108, 24947, 22625, 130594, 109015, 8889, 65720, 15365, 97670, 9220, 2571,
                      20503, 5945, 41329, 100741, 97287, 12110],
                     [38868, 45479, 57571, 6737, 72210, 63861, 96321, 13884, 11457, 21759, 98618,
                      31470, 46911, 13451, 19267, 116246, 33126, 4799, 6433, 15760, 7427, 69476,
                      148255, 37335, 3420, 11323, 24074, 5470, 180399, 13830, 11711, 7465, 25347,
                      40108, 24947, 22625, 130594, 109015, 8889, 65720, 15365, 97670, 9220, 2571,
                      20503, 5945, 41329, 100741, 97287, 12110, 174700, 67024, 131740, 199059,
                      30925, 30815, 44646, 11123, 149143, 47438, 18324, 141841, 286305, 46632,
                      17501, 1442, 18246, 4496, 238302, 36906, 185173, 272552, 286309, 129195, 70089,
                      223457, 257023, 145921, 28005, 76323, 121742, 257012, 125859, 26626, 58380, 46213,
                      13076, 26613, 121117, 8842, 9449, 136908, 257533, 27822, 880, 11255, 18917, 34561,
                      261762, 71372],
                     [38868, 45479, 57571, 6737, 72210, 63861, 96321, 13884, 11457, 21759, 98618, 31470, 46911, 13451,
                      19267, 116246, 33126, 4799, 6433, 15760, 7427, 69476, 148255, 37335, 3420, 11323, 24074, 5470,
                      180399, 13830, 11711, 7465, 25347, 40108, 24947, 22625, 130594, 109015, 8889, 65720, 15365, 97670,
                      9220, 2571, 20503, 5945, 41329, 100741, 97287, 12110, 174700, 67024, 131740, 199059, 30925, 30815,
                      44646, 11123, 149143, 47438, 18324, 141841, 286305, 46632, 17501, 1442, 18246, 4496, 238302,
                      36906, 185173, 272552, 286309, 129195, 70089, 223457, 257023, 145921, 28005, 76323, 121742,
                      257012, 125859, 26626, 58380, 46213, 13076, 26613, 121117, 8842, 9449, 136908, 257533, 27822, 880,
                      11255, 18917, 34561, 261762, 71372, 51230, 61546, 257018, 25670, 2419, 23414, 162943, 5721, 35249,
                      10346, 114816, 319822, 134547, 257020, 257021, 219725, 117657, 270050, 28215, 27627, 53039, 91011,
                      71987, 11567, 27777, 41089, 112650, 20956, 27264, 192103, 92244, 2962, 77813, 53899, 59792, 44729,
                      256418, 56290, 30028, 88989, 6779, 18114, 61555, 5184, 38115, 252697, 50034, 82743, 162855, 38508,
                      21835, 8027, 115586, 63460, 16393, 33064, 53611, 21466, 89910, 10516, 41815, 34793, 36868, 32534,
                      43377, 109825, 116555, 115457, 225902, 41367, 19114, 67140, 13235, 124395, 68242, 12345, 287845,
                      76105, 5767, 45962, 36172, 42671, 52692, 33839, 286355, 13877, 26574, 56036, 286307, 8847, 119707,
                      89043, 27911, 184606, 41908, 65957, 270519, 137772, 70047, 114253],
                     [38868, 45479, 57571, 6737, 72210, 63861, 96321, 13884, 11457, 21759, 98618, 31470, 46911, 13451,
                      19267, 116246, 33126, 4799, 6433, 15760, 7427, 69476, 148255, 37335, 3420, 11323, 24074, 5470,
                      180399, 13830, 11711, 7465, 25347, 40108, 24947, 22625, 130594, 109015, 8889, 65720, 15365, 97670,
                      9220, 2571, 20503, 5945, 41329, 100741, 97287, 12110, 174700, 67024, 131740, 199059, 30925, 30815,
                      44646, 11123, 149143, 47438, 18324, 141841, 286305, 46632, 17501, 1442, 18246, 4496, 238302,
                      36906, 185173, 272552, 286309, 129195, 70089, 223457, 257023, 145921, 28005, 76323, 121742,
                      257012, 125859, 26626, 58380, 46213, 13076, 26613, 121117, 8842, 9449, 136908, 257533, 27822, 880,
                      11255, 18917, 34561, 261762, 71372, 51230, 61546, 257018, 25670, 2419, 23414, 162943, 5721, 35249,
                      10346, 114816, 319822, 134547, 257020, 257021, 219725, 117657, 270050, 28215, 27627, 53039, 91011,
                      71987, 11567, 27777, 41089, 112650, 20956, 27264, 192103, 92244, 2962, 77813, 53899, 59792, 44729,
                      256418, 56290, 30028, 88989, 6779, 18114, 61555, 5184, 38115, 252697, 50034, 82743, 162855, 38508,
                      21835, 8027, 115586, 63460, 16393, 33064, 53611, 21466, 89910, 10516, 41815, 34793, 36868, 32534,
                      43377, 109825, 116555, 115457, 225902, 41367, 19114, 67140, 13235, 124395, 68242, 12345, 287845,
                      76105, 5767, 45962, 36172, 42671, 52692, 33839, 286355, 13877, 26574, 56036, 286307, 8847, 119707,
                      89043, 27911, 184606, 41908, 65957, 270519, 137772, 70047, 114253, 124535, 185919, 35481, 319831,
                      19862, 15737, 66095, 286318, 286348, 305251, 6948, 193651, 45685, 287674, 320842, 9812, 54232,
                      5771, 234780, 286317, 89545, 114575, 13540, 70601, 48525, 286315, 286351, 69054, 142571, 179483,
                      43227, 92634, 286312, 286322, 286327, 77935, 130279, 22159, 41110, 41825, 7372, 165355, 229756,
                      284923, 37572, 55007, 20696, 34975, 53643, 305407, 18972, 307090, 29824, 160046, 256807, 130303,
                      6735, 23574, 21765, 68391, 32952, 178333, 286340, 33407, 20453, 319824, 3886, 18075, 7174, 39744,
                      20168, 283362, 6909, 63227, 286308, 286323, 286324, 286358, 294935, 307088, 307089, 102480, 38231,
                      27999, 57173, 104397, 321670, 105781, 9858, 30023, 32707, 286328, 319826, 319828, 319829, 319832,
                      319836, 320839, 320841, 325271, 45116, 72070, 5028, 38700, 55885, 274213, 286304, 286311, 286316,
                      286321, 286325, 286326, 286352, 286357, 286509, 294936, 39420, 35298, 275945, 283981, 82316,
                      86463, 286303, 286306, 286310, 286313, 286314, 286319, 286320, 286339, 286341, 286342, 286343,
                      286344, 286345, 286346, 286347, 286349, 286350, 286353, 286354, 286356, 286359, 286360, 286397,
                      286511, 294937, 306215, 308943, 8930, 84775, 225557, 6532, 17202, 32221, 46607, 205395, 193978,
                      319357, 28810, 44888, 274748, 19306, 34135, 19909, 38603, 23759, 41368, 65983, 181513, 53028,
                      16245, 305408, 24418, 35244, 11406, 23409, 298337, 15129, 16242, 121384, 5489, 42130, 55019,
                      35213, 13723, 52709, 181479, 42677, 8879, 9453, 81357, 50783, 96017, 81996, 12300, 199804, 14168,
                      2810, 28926]
                     ],
            'facebook': [[107, 1684, 1912, 3437, 0],
                         [107, 1684, 1912, 3437, 0, 2543, 2347],
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800],
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800, 1663,
                          1352, 2266, 483, 348, 1730, 1985, 1941, 2233, 2142, 1431],  # twenty seeds
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800, 1663,
                          1352, 2266, 483, 348, 1730, 1985, 1941, 2233, 2142, 1431,
                          1199, 1584, 2206, 1768, 2229, 2410, 2611, 1086, 1589, 2047,
                          2218, 2078, 1993, 2123, 1746, 2464, 1827, 2240, 2507, 2560,
                          2244, 1983, 2309, 1126, 2088, 2131, 2340, 2602, 2324, 2369],  # fifty seeds
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800, 1663, 1352,
                          2266, 483, 348, 1730, 1985, 1941, 2233, 2142, 1431, 1199, 1584,
                          2206, 1768, 2229, 2410, 2611, 1086, 1589, 2047, 2218, 2078, 1993,
                          2123, 1746, 2464, 1827, 2240, 2507, 2560, 2244, 1983, 2309, 1126,
                          2088, 2131, 2340, 2602, 2324, 2369, 2590, 2542, 2604, 1804, 2073,
                          2220, 2607, 2188, 1390, 2059, 2172, 1943, 2150, 1833, 1946, 2428,
                          2526, 1377, 1612, 1917, 2201, 2331, 2601, 1621, 1938, 2090, 2384,
                          2118, 2564, 2624, 1714, 1962, 2030, 2586, 1559, 2064, 2184, 2625,
                          1707, 2275, 2593, 2615, 2111, 2103, 2290, 1078, 2323, 2414, 1376, 1613],  # one hundred seeds
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800, 1663, 1352, 2266, 483, 348, 1730, 1985,
                          1941, 2233, 2142, 1431, 1199, 1584, 2206, 1768, 2229, 2410, 2611, 1086, 1589, 2047, 2218,
                          2078, 1993, 2123, 1746, 2464, 1827, 2240, 2507, 2560, 2244, 1983, 2309, 1126, 2088, 2131,
                          2340, 2602, 2324, 2369, 2590, 2542, 2604, 1804, 2073, 2220, 2607, 2188, 1390, 2059, 2172,
                          1943, 2150, 1833, 1946, 2428, 2526, 1377, 1612, 1917, 2201, 2331, 2601, 1621, 1938, 2090,
                          2384, 2118, 2564, 2624, 1714, 1962, 2030, 2586, 1559, 2064, 2184, 2625, 1707, 2275, 2593,
                          2615, 2111, 2103, 2290, 1078, 2323, 2414, 1376, 1613, 1835, 2339, 2600, 2104, 2500, 2271,
                          2326, 1610, 2376, 2395, 1399, 1984, 2139, 2409, 2492, 1622, 2468, 2093, 2354, 1971, 1979,
                          2045, 2381, 1391, 2199, 2043, 2278, 1211, 2033, 2037, 2200, 2553, 2630, 2081, 1966, 2356,
                          1551, 2007, 2140, 1577, 686, 2404, 1471, 2124, 2460, 2069, 2190, 2352, 2374, 2655, 925, 2363,
                          946, 1367, 2328, 2638, 1059, 1839, 2423, 2520, 2559, 2598, 2108, 2578, 2619, 2054, 2074, 2550,
                          2283, 1918, 2446, 2549, 1554, 2289, 2333, 2112, 2154, 2482, 414, 1516, 2133, 1184, 2020, 2121,
                          2370, 2551, 2253, 1185, 1522, 1736, 1813, 2087, 2308, 1718, 2005, 2257, 2299, 2561, 993,
                          2282],  # 200
                         [107, 1684, 1912, 3437, 0, 2543, 2347, 1888, 1800, 1663, 1352, 2266, 483, 348, 1730, 1985,
                          1941, 2233, 2142, 1431, 1199, 1584, 2206, 1768, 2229, 2410, 2611, 1086, 1589, 2047, 2218,
                          2078, 1993, 2123, 1746, 2464, 1827, 2240, 2507, 2560, 2244, 1983, 2309, 1126, 2088, 2131,
                          2340, 2602, 2324, 2369, 2590, 2542, 2604, 1804, 2073, 2220, 2607, 2188, 1390, 2059, 2172,
                          1943, 2150, 1833, 1946, 2428, 2526, 1377, 1612, 1917, 2201, 2331, 2601, 1621, 1938, 2090,
                          2384, 2118, 2564, 2624, 1714, 1962, 2030, 2586, 1559, 2064, 2184, 2625, 1707, 2275, 2593,
                          2615, 2111, 2103, 2290, 1078, 2323, 2414, 1376, 1613, 1835, 2339, 2600, 2104, 2500, 2271,
                          2326, 1610, 2376, 2395, 1399, 1984, 2139, 2409, 2492, 1622, 2468, 2093, 2354, 1971, 1979,
                          2045, 2381, 1391, 2199, 2043, 2278, 1211, 2033, 2037, 2200, 2553, 2630, 2081, 1966, 2356,
                          1551, 2007, 2140, 1577, 686, 2404, 1471, 2124, 2460, 2069, 2190, 2352, 2374, 2655, 925, 2363,
                          946, 1367, 2328, 2638, 1059, 1839, 2423, 2520, 2559, 2598, 2108, 2578, 2619, 2054, 2074, 2550,
                          2283, 1918, 2446, 2549, 1554, 2289, 2333, 2112, 2154, 2482, 414, 1516, 2133, 1184, 2020, 2121,
                          2370, 2551, 2253, 1185, 1522, 1736, 1813, 2087, 2308, 1718, 2005, 2257, 2299, 2561, 993, 2282,
                          2095, 2276, 1986, 2408, 1238, 1799, 2040, 2573, 1557, 1929, 2348, 2504, 2654, 1879, 2336,
                          1017, 1420, 1604, 2187, 916, 1146, 2032, 2083, 2359, 2433, 1331, 1662, 1945, 2122, 2430, 1603,
                          1793, 2495, 2546, 1006, 1076, 1132, 1222, 1447, 2117, 2292, 1107, 2068, 2063, 2084, 2307,
                          2521, 2575, 2511, 2212, 2539, 1153, 1717, 2153, 2334, 2386, 2138, 2510, 1250, 1361, 1669,
                          2839, 2485, 1329, 1598, 2086, 2115, 1256, 1488, 2555, 1997, 2109, 2469, 2646, 1926, 2183,
                          2509, 136, 376, 2216, 1175, 1456, 2102, 2471, 1509, 1757, 1791, 1816, 3363, 2556, 917, 1124,
                          1902, 2268, 2467, 2623, 2072, 2224, 2279, 2261, 980, 1335, 1620, 2149, 2165, 1665, 1823, 2629,
                          2642, 896, 1269, 1750, 2463, 2077, 2484, 1230, 1491, 2327, 2592, 1925, 1255, 1277, 1467, 1570,
                          1689, 2461, 2237, 2329, 2506, 1079, 1101, 1341, 1683, 1867, 2038, 2071, 2302, 1920, 1953,
                          2046, 475, 1117, 1330, 1547, 1668, 2247, 2319, 2649, 3101, 2294, 2754, 2300, 1761, 1783, 1868,
                          2491, 2125, 2344, 1004, 1267, 2174, 1959, 1947, 1842, 1849, 2241, 3291, 1125, 1520, 1600,
                          1608, 1617, 1675, 2176, 2098, 2418, 2223, 2567, 2742, 3082, 2579, 2631, 428, 637, 947, 966,
                          1173, 1721, 1752, 2053, 3397, 2056, 1214, 1619, 2180, 2617, 1172, 1291, 1809, 2189]  # 400

                         ],
            'p2p': [[2436, 6611, 3548, 2784, 3846],
                    [2436, 6611, 3548, 2784, 3846, 7027, 3003],
                    [2436, 6611, 3548, 2784, 3846, 7027, 3003, 3700, 6029],
                    [822, 51, 351, 1389, 530, 356, 563, 825, 565, 1074, 352, 90, 1126, 534, 752, 150, 706, 95, 531,
                     1042],
                    [822, 51, 351, 1389, 530, 356, 563, 825, 565, 1074, 352, 90, 1126, 534, 752, 150, 706, 95, 531,
                     1042, 355, 836, 349, 354, 96, 387, 649, 93, 824, 1309, 176, 78, 350, 751, 353, 837, 1365, 79, 88,
                     1558, 91, 532, 533, 89, 226, 750, 703, 1041, 826, 704],
                    [822, 51, 351, 1389, 530, 356, 563, 825, 565, 1074, 352, 90, 1126, 534, 752, 150, 706, 95, 531,
                     1042, 355, 836, 349, 354, 96, 387, 649, 93, 824, 1309, 176, 78, 350, 751, 353, 837, 1365, 79, 88,
                     1558, 91, 532, 533, 89, 226, 750, 703, 1041, 826, 704, 1821, 753, 708, 823, 564, 92, 3151, 707, 94,
                     1493, 1557, 1211, 1656, 679, 1073, 2144, 284, 705, 166, 1625, 54, 428, 636, 1520, 2756, 161, 2332,
                     737, 639, 2717, 36, 1720, 1799, 2202, 2220, 1586, 1438, 1525, 2084, 410, 2576, 3192, 1509, 567,
                     157, 220, 1770, 268, 313, 856],
                    [822, 51, 351, 1389, 530, 356, 563, 825, 565, 1074, 352, 90, 1126, 534, 752, 150, 706, 95, 531,
                     1042, 355, 836, 349, 354, 96, 387, 649, 93, 824, 1309, 176, 78, 350, 751, 353, 837, 1365, 79, 88,
                     1558, 91, 532, 533, 89, 226, 750, 703, 1041, 826, 704, 1821, 753, 708, 823, 564, 92, 3151, 707, 94,
                     1493, 1557, 1211, 1656, 679, 1073, 2144, 284, 705, 166, 1625, 54, 428, 636, 1520, 2756, 161, 2332,
                     737, 639, 2717, 36, 1720, 1799, 2202, 2220, 1586, 1438, 1525, 2084, 410, 2576, 3192, 1509, 567,
                     157, 220, 1770, 268, 313, 856, 452, 495, 805, 405, 102, 2197, 549, 1481, 2451, 990, 541, 2948,
                     5977, 807, 1205, 3124, 1220, 589, 71, 930, 260, 2298, 409, 3064, 2978, 2592, 2630, 1342, 796, 1705,
                     1146, 1427, 1159, 1643, 1322, 2140, 1647, 2173, 328, 572, 2205, 3198, 1881, 1685, 267, 306, 1147,
                     795, 1307, 850, 888, 2968, 1223, 767, 803, 1151, 916, 1421, 3355, 1288, 4860, 1743, 2035, 1436, 72,
                     421, 215, 232, 2308, 2285, 1265, 3158, 2347, 324, 1494, 1472, 578, 790, 618, 1579, 2532, 1952,
                     2631, 1148, 610, 937, 626, 2759, 1346, 3447, 3174, 3197, 3349, 4756, 4235, 6266, 2038, 2041, 30,
                     73],  # 200
                    [822, 51, 351, 1389, 530, 356, 563, 825, 565, 1074, 352, 90, 1126, 534, 752, 150, 706, 95, 531,
                     1042, 355, 836, 349, 354, 96, 387, 649, 93, 824, 1309, 176, 78, 350, 751, 353, 837, 1365, 79, 88,
                     1558, 91, 532, 533, 89, 226, 750, 703, 1041, 826, 704, 1821, 753, 708, 823, 564, 92, 3151, 707, 94,
                     1493, 1557, 1211, 1656, 679, 1073, 2144, 284, 705, 166, 1625, 54, 428, 636, 1520, 2756, 161, 2332,
                     737, 639, 2717, 36, 1720, 1799, 2202, 2220, 1586, 1438, 1525, 2084, 410, 2576, 3192, 1509, 567,
                     157, 220, 1770, 268, 313, 856, 452, 495, 805, 405, 102, 2197, 549, 1481, 2451, 990, 541, 2948,
                     5977, 807, 1205, 3124, 1220, 589, 71, 930, 260, 2298, 409, 3064, 2978, 2592, 2630, 1342, 796, 1705,
                     1146, 1427, 1159, 1643, 1322, 2140, 1647, 2173, 328, 572, 2205, 3198, 1881, 1685, 267, 306, 1147,
                     795, 1307, 850, 888, 2968, 1223, 767, 803, 1151, 916, 1421, 3355, 1288, 4860, 1743, 2035, 1436, 72,
                     421, 215, 232, 2308, 2285, 1265, 3158, 2347, 324, 1494, 1472, 578, 790, 618, 1579, 2532, 1952,
                     2631, 1148, 610, 937, 626, 2759, 1346, 3447, 3174, 3197, 3349, 4756, 4235, 6266, 2038, 2041, 30,
                     73, 657, 1409, 256, 774, 522, 155, 700, 1479, 746, 527, 1539, 1767, 2303, 1873, 4356, 247, 251,
                     395, 487, 2353, 1344, 1395, 1840, 393, 1556, 1471, 1504, 2654, 2523, 2864, 2571, 952, 1931, 584,
                     1524, 638, 4621, 1455, 2781, 2794, 1564, 908, 1458, 3061, 3140, 3169, 3266, 3406, 3415, 3586, 3554,
                     3567, 3597, 1742, 3893, 3782, 3897, 4042, 4182, 4461, 4753, 1, 1063, 2034, 2050, 40, 66, 300, 1138,
                     1274, 962, 145, 175, 2190, 1972, 2211, 632, 209, 388, 2242, 385, 1379, 277, 286, 2881, 310, 318,
                     494, 2361, 855, 2384, 372, 397, 407, 2428, 2504, 2447, 447, 2463, 454, 528, 480, 2496, 2006, 2501,
                     556, 570, 2597, 2604, 840, 2679, 2661, 617, 2721, 1360, 2728, 2748, 2800, 2902, 1036, 1803, 1016,
                     3088, 3132, 3133, 1116, 5079, 3400, 1710, 1646, 4154, 4325, 4559, 4650, 5109, 5398, 2, 1544, 1562,
                     237, 15, 347, 39, 1169, 1029, 625, 76, 159, 611, 2123, 3671, 1369, 963, 2184, 200, 201, 345, 2213,
                     212, 1189, 1704, 2315, 2268, 642, 264, 1763, 2300, 2294, 2296, 307, 2321, 294, 5464, 2344, 2719,
                     4627, 944, 2412, 1516, 1517, 2477, 2479, 456, 1046, 717, 2490, 479, 1254, 1017, 515, 847, 1888,
                     1890, 2551, 4492, 554, 810, 2641, 4737, 2675]  # 400
                    ],
            'BA': [[239, 8, 47, 86, 170],
                   [5, 10, 2, 0, 8, 22, 1, 3, 18, 7, 4, 23, 28, 6, 20]]
        }
        self.cost = [sum(self.budget) / self.num_seeds for _ in range(self.num_seeds)]

        self.N_GAMES = 50
        self.MAX_STEPS_times = 1
        self.MAX_STEPS = 200 * self.MAX_STEPS_times  # 6,000 episodes
        self.p_step = 20
        self.l_step = self.MAX_STEPS * 0.2
        self.maddpg_l_step = self.l_step
        self.n_actions = 2
        self.device = T.device("cuda" if T.cuda.is_available() else "cpu")

    def re_num(self, dataset_item, numAgents, numSeeds, numStepTimes):
        self.item = dataset_item
        self.num_agents = numAgents
        self.num_seeds = numSeeds
        if numSeeds == 5:
            self.dataset_item = 0
        elif numSeeds == 7:
            self.dataset_item = 1
        elif numSeeds == 9:
            self.dataset_item = 2
        elif numSeeds == 20:
            self.dataset_item = 3
        elif numSeeds == 50:
            self.dataset_item = 4
        elif numSeeds == 100:
            self.dataset_item = 5
        elif numSeeds == 200:
            self.dataset_item = 6
        else:
            self.dataset_item = 7

        if self.num_seeds % 2 == 1:
            self.budget = [(self.num_seeds + 1) / 2] * self.num_agents
        else:
            self.budget = [self.num_seeds / 2] * self.num_agents
        self.MAX_STEPS_times = numStepTimes
        self.MAX_STEPS = 200 * self.MAX_STEPS_times
        self.cost = [sum(self.budget) / self.num_seeds for _ in range(self.num_seeds)]

    def reInit(self):
        self.rewardPlatform = []
        self.successReward = []
        self.seedsPrice = {}
        for i in range(self.num_seeds):
            self.seedsPrice[i] = []
        self.rewardAgent = {}
        self.agentBudleft = {}
        self.successSeeds = {}
        self.score = []
        for i in range(self.num_agents):
            self.rewardAgent[i] = []
            self.agentBudleft[i] = []
            self.successSeeds[i] = []


# 高斯噪声
class GaussDistribution(object):
    def __init__(self, high, low, sigma=0.5):
        self.mu = 1
        self.sigma = sigma
        self.high = high
        self.low = low

    def get_action(self, action):
        actions = []
        for i in action:
            if i < 0:
                actions.append(np.clip(random.gauss(0, self.sigma), self.low, self.high))
            else:
                x_ = norm.ppf(i, loc=self.mu, scale=self.sigma)
                actions.append(np.clip(x_ + random.gauss(0, self.sigma), self.low, self.high))
        return actions

    def get_action_others(self, action):
        low = self.low
        high = self.high

        action = low + (action + 1.0) * 0.5 * (high - low)
        action = np.clip(action, low, high)

        return action

    def get_reverse_action(self, action):
        low = self.low
        high = self.high

        action = 2 * (action - low) / (high - low) - 1
        action = np.clip(action, low, high)

        return action
